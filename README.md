# CVE-in-My-Code

## Description
CVE-in-My-Code is a tool designed to fetch Common Vulnerabilities and Exposures (CVE) data and store it in a SQLite database locally. It periodically retrieves CVE data within a specified date range (depends on cron time) and notifies you for any new CVE entries via Slack. This script has been designed in such a way that it will pull the cve data between the current date&time to the cron time. If you set-up the cron to run this script in every 2 hours (0 */2 * * *) then it will automatically pulls the data of last 2 hour only.

## Features
- Automated retrieval and storage of CVE data periodically using [nvd API](https://nvd.nist.gov/developers/vulnerabilities).
- Slack Notifications for each new CVE entries using slack webhooks.
- Health check mechanism using webhooks.

## Prerequisite
- Python 3.x is required.
- SQLite database.

## Setup Usage:
1. Clone the repository:
```
git clone https://github.com/abhiunix/cve-in-my-code
cd cve-in-my-code
```

2. Install the required dependencies:
```
pip install -r requirements.txt
```

3. Set up environment variables:
- Create a `.env` file in the project directory.
- Define the following variables in the `.env` file:
  ```
  webhook_url=<your_slack_webhook_url>
  health_check_webhook=<your_health_check_webhook_url>
  ```



## Usage
Run the script manually for the initial setup:
```
python3 timestamp.py
python3 cve-in-my-code.py
```
### Configure the cronjob:
- Open the crontab file:
  ```
  crontab -e
  ```

- Add the following line to run the script every 5 minutes:
  ```
  */5 * * * * /usr/bin/python3 /path/to/cve-in-my-code.py
  ```

- Save and exit the crontab file.
## Contributions
Contributions to CVE-in-My-Code are welcome! Please fork the repository, make your enhancements, and submit a pull request.


## To do:
- [ ] Parse the `description` of the vulnerabilities and extract `framework/Library/Software` name and vulnerable version.
- [ ] Search for the extracted `library` and `version` in organizations codebase using github/bitbucket APIs.
- [ ] Actionable alerts on slack if any vulnerable `library/framework` found in code base.
- [ ] Add other CVE databases.
